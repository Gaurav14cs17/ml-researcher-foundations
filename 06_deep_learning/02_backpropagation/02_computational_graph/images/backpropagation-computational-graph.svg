<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 700">
  <defs>
    <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
        <path d="M0,0 L0,6 L9,3 z" fill="#212529" />
      </marker>
    <marker id="arrowred" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
        <path d="M0,0 L0,6 L9,3 z" fill="#dc3545" />
      </marker>
  </defs>

  <!-- Background -->
  <rect width="1100" height="700" fill="#f8f9fa" rx="8"/>
  
  <!-- Title -->
  <text x="550" y="30" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle" fill="#212529">
    Backpropagation: Computational Graph
  </text>
  
  <!-- Subtitle -->
  <text x="550" y="55" font-family="Arial, sans-serif" font-size="15" text-anchor="middle" fill="#212529" font-style="italic">
    Chain Rule Application: How Gradients Flow Backwards
  </text>
  
  <!-- Forward pass (top half) -->
  <g id="forward">
    <text x="100" y="100" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#007bff">
      Forward Pass â†’
    </text>
    
    <!-- Input -->
    <circle cx="150" cy="150" r="30" fill="#007bff" stroke="#007bff" stroke-width="3"/>
    <text x="150" y="155" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#212529" font-weight="bold">x</text>
    <text x="150" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#212529">= 2</text>
    
    <!-- W1 -->
    <line x1="180" y1="150" x2="270" y2="150" stroke="#dee2e6" stroke-width="3" marker-end="url(#arrowblue)"/>
    <rect x="210" y="125" width="50" height="30" fill="#212529" stroke="#007bff" stroke-width="2" rx="5"/>
    <text x="235" y="145" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#007bff" font-weight="bold">wâ‚=3</text>
    
    <!-- a = wx -->
    <circle cx="320" cy="150" r="30" fill="#6f42c1" stroke="#6f42c1" stroke-width="3"/>
    <text x="320" y="155" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#212529" font-weight="bold">a</text>
    <text x="320" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#212529">= wx = 6</text>
    
    <!-- +b -->
    <line x1="350" y1="150" x2="440" y2="150" stroke="#dee2e6" stroke-width="3" marker-end="url(#arrowblue)"/>
    <rect x="380" y="125" width="50" height="30" fill="#212529" stroke="#6f42c1" stroke-width="2" rx="5"/>
    <text x="405" y="145" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#6f42c1" font-weight="bold">+b=2</text>
    
    <!-- z = a + b -->
    <circle cx="490" cy="150" r="30" fill="#fd7e14" stroke="#fd7e14" stroke-width="3"/>
    <text x="490" y="155" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#212529" font-weight="bold">z</text>
    <text x="490" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#212529">= a+b = 8</text>
    
    <!-- Ïƒ (activation) -->
    <line x1="520" y1="150" x2="610" y2="150" stroke="#dee2e6" stroke-width="3" marker-end="url(#arrowblue)"/>
    <rect x="550" y="125" width="50" height="30" fill="#212529" stroke="#fd7e14" stroke-width="2" rx="5"/>
    <text x="575" y="145" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#fd7e14" font-weight="bold">Ïƒ(z)</text>
    
    <!-- h = Ïƒ(z) -->
    <circle cx="660" cy="150" r="30" fill="#dc3545" stroke="#dc3545" stroke-width="3"/>
    <text x="660" y="155" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#212529" font-weight="bold">h</text>
    <text x="660" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#212529">= Ïƒ(8) = 1</text>
    
    <!-- W2 -->
    <line x1="690" y1="150" x2="780" y2="150" stroke="#dee2e6" stroke-width="3" marker-end="url(#arrowblue)"/>
    <rect x="720" y="125" width="50" height="30" fill="#212529" stroke="#dc3545" stroke-width="2" rx="5"/>
    <text x="745" y="145" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#dc3545" font-weight="bold">wâ‚‚=4</text>
    
    <!-- y_pred -->
    <circle cx="830" cy="150" r="30" fill="#28a745" stroke="#28a745" stroke-width="3"/>
    <text x="830" y="155" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#212529" font-weight="bold">Å·</text>
    <text x="830" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#212529">= 4</text>
    
    <!-- Loss -->
    <line x1="860" y1="150" x2="950" y2="150" stroke="#dee2e6" stroke-width="3" marker-end="url(#arrowblue)"/>
    <rect x="890" y="125" width="50" height="30" fill="#212529" stroke="#28a745" stroke-width="2" rx="5"/>
    <text x="915" y="145" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#28a745" font-weight="bold">Loss</text>
    
    <!-- L -->
    <circle cx="1000" cy="150" r="30" fill="#dc3545" stroke="#a93226" stroke-width="3"/>
    <text x="1000" y="155" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#212529" font-weight="bold">L</text>
    <text x="1000" y="200" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#212529">= 2</text>
  </g>
  
  <!-- Backward pass (bottom half) -->
  <g id="backward">
    <text x="1000" y="330" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#dc3545" text-anchor="end">
      â† Backward Pass (Gradients)
    </text>
    
    <!-- dL/dL = 1 -->
    <text x="1000" y="390" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚L = 1
    </text>
    
    <!-- Arrow back to y_pred -->
    <line x1="970" y1="380" x2="860" y2="380" stroke="#dc3545" stroke-width="3" marker-end="url(#arrowred)"/>
    <text x="915" y="370" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚Å·
    </text>
    
    <!-- dL/dy_pred -->
    <text x="830" y="390" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚Å· = 1
    </text>
    
    <!-- Arrow to h (through w2) -->
    <line x1="800" y1="380" x2="690" y2="380" stroke="#dc3545" stroke-width="3" marker-end="url(#arrowred)"/>
    <text x="745" y="370" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚h = wâ‚‚
    </text>
    
    <!-- dL/dh -->
    <text x="660" y="390" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚h = 4
    </text>
    
    <!-- Arrow to z (through Ïƒ) -->
    <line x1="630" y1="380" x2="520" y2="380" stroke="#dc3545" stroke-width="3" marker-end="url(#arrowred)"/>
    <text x="575" y="370" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚z = Ïƒ'(z)Â·âˆ‚L/âˆ‚h
    </text>
    
    <!-- dL/dz -->
    <text x="490" y="390" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚z = 0
    </text>
    
    <!-- Arrow to a -->
    <line x1="460" y1="380" x2="350" y2="380" stroke="#dc3545" stroke-width="3" marker-end="url(#arrowred)"/>
    <text x="405" y="370" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚a = âˆ‚L/âˆ‚z
    </text>
    
    <!-- dL/da -->
    <text x="320" y="390" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚a = 0
    </text>
    
    <!-- Arrow to x (through w1) -->
    <line x1="290" y1="380" x2="180" y2="380" stroke="#dc3545" stroke-width="3" marker-end="url(#arrowred)"/>
    <text x="235" y="370" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚x = wâ‚Â·âˆ‚L/âˆ‚a
    </text>
    
    <!-- dL/dx -->
    <text x="150" y="390" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#dc3545" font-weight="bold">
      âˆ‚L/âˆ‚x = 0
    </text>
  </g>
  
  <!-- Weight gradients (side boxes) -->
  <g id="weight-gradients">
    <!-- dL/dw1 -->
    <rect x="200" y="240" width="80" height="60" fill="#fff5e6" stroke="#fd7e14" stroke-width="3" rx="5"/>
    <text x="240" y="260" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#fd7e14" font-weight="bold">
      âˆ‚L/âˆ‚wâ‚
    </text>
    <text x="240" y="278" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#212529">
      = xÂ·âˆ‚L/âˆ‚a
    </text>
    <text x="240" y="293" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#dc3545" font-weight="bold">
      = 0
    </text>
    
    <!-- dL/db -->
    <rect x="370" y="240" width="80" height="60" fill="#fff5e6" stroke="#fd7e14" stroke-width="3" rx="5"/>
    <text x="410" y="260" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#fd7e14" font-weight="bold">
      âˆ‚L/âˆ‚b
    </text>
    <text x="410" y="278" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#212529">
      = âˆ‚L/âˆ‚z
    </text>
    <text x="410" y="293" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#dc3545" font-weight="bold">
      = 0
    </text>
    
    <!-- dL/dw2 -->
    <rect x="710" y="240" width="80" height="60" fill="#fff5e6" stroke="#fd7e14" stroke-width="3" rx="5"/>
    <text x="750" y="260" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#fd7e14" font-weight="bold">
      âˆ‚L/âˆ‚wâ‚‚
    </text>
    <text x="750" y="278" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#212529">
      = hÂ·âˆ‚L/âˆ‚Å·
    </text>
    <text x="750" y="293" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#dc3545" font-weight="bold">
      = 1
    </text>
  </g>
  
  <!-- Chain rule explanation -->
  <rect x="50" y="450" width="1000" height="230" fill="#212529" stroke="#007bff" stroke-width="3" rx="10"/>
  <text x="550" y="485" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#007bff">
    The Chain Rule: Key to Backpropagation
  </text>
  
  <text x="70" y="520" font-family="Arial, sans-serif" font-size="14" fill="#212529">
    <tspan x="70" dy="0" font-weight="bold" fill="#dc3545">Core Idea:</tspan>
    <tspan> For any intermediate variable z, the gradient flows through multiplication:</tspan>
  </text>
  
  <rect x="200" y="535" width="700" height="40" fill="#212529" rx="5"/>
  <text x="550" y="560" font-family="Arial, sans-serif" font-size="16" text-anchor="middle" fill="#212529" font-weight="bold">
    âˆ‚L/âˆ‚x = (âˆ‚L/âˆ‚y) Â· (âˆ‚y/âˆ‚x)
  </text>
  
  <text x="70" y="600" font-family="Arial, sans-serif" font-size="13" fill="#212529">
    <tspan x="70" dy="0" font-weight="bold">Example:</tspan>
    <tspan> To compute âˆ‚L/âˆ‚wâ‚‚:</tspan>
    <tspan x="80" dy="22">1. Å· = wâ‚‚Â·h â†’ Forward: compute Å·</tspan>
    <tspan x="80" dy="20">2. âˆ‚L/âˆ‚wâ‚‚ = (âˆ‚L/âˆ‚Å·) Â· (âˆ‚Å·/âˆ‚wâ‚‚) = (âˆ‚L/âˆ‚Å·) Â· h â† Backward: multiply gradients</tspan>
    <tspan x="80" dy="20">3. Update: wâ‚‚ â† wâ‚‚ - Î±Â·(âˆ‚L/âˆ‚wâ‚‚)</tspan>
  </text>
  
  <text x="550" y="670" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#28a745" font-weight="bold"><tspan x="550" dy="0">ğŸ’¡ This is why it's called "backpropagation" - we propagate</tspan><tspan x="550" dy="1.2em">gradients backwards through the graph!</tspan></text>
</svg>

