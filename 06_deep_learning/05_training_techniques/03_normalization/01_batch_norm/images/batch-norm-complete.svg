<?xml version="1.0" ?>
<ns0:svg xmlns:ns0="http://www.w3.org/2000/svg" viewBox="0.0 0.0 2475.0 1912.5">
  <ns0:defs>
    <ns0:marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <ns0:path d="M0,0 L0,6 L9,3 z" fill="#2e7d32"/>
    </ns0:marker>
  </ns0:defs>
  <ns0:text x="550" y="30" font-size="22" font-weight="bold" text-anchor="middle" fill="#1a237e">
    Batch Normalization: Complete Algorithm &amp; Benefits
  </ns0:text>
  <ns0:g transform="translate(50, 80)">
    <ns0:text x="500" y="55.0" font-size="16" font-weight="bold" text-anchor="middle" fill="#1565c0">
      1. Algorithm (Training Time)
    </ns0:text>
    <ns0:rect x="0" y="20" width="2250.0" height="540.0" fill="#f8f9fa" stroke="#007bff" stroke-width="3" rx="8"/>
    <ns0:g transform="translate(30, 50)">
      <ns0:text x="0" y="80.0" font-size="14" fill="#1a237e">
        <ns0:tspan font-weight="bold" fill="#1565c0">Input:</ns0:tspan>
         Mini-batch ğ“‘ = {xâ‚, xâ‚‚, ..., x_m}
      </ns0:text>
      <ns0:g transform="translate(0, 30)">
        <ns0:rect x="0" y="0" width="940" height="30" fill="#1a237e" stroke="#007bff" stroke-width="1" rx="3"/>
        <ns0:text x="10" y="105.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#1565c0">Step 1:</ns0:tspan>
           Compute mini-batch mean:
          <ns0:tspan font-family="Arial, sans-serif" dx="10">Î¼_ğ“‘ = (1/m) Î£áµ¢ xáµ¢</ns0:tspan>
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 65)">
        <ns0:rect x="0" y="0" width="940" height="30" fill="#1a237e" stroke="#007bff" stroke-width="1" rx="3"/>
        <ns0:text x="10" y="130.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#1565c0">Step 2:</ns0:tspan>
           Compute mini-batch variance:
          <ns0:tspan font-family="Arial, sans-serif" dx="10">ÏƒÂ²_ğ“‘ = (1/m) Î£áµ¢ (xáµ¢ - Î¼_ğ“‘)Â²</ns0:tspan>
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 100)">
        <ns0:rect x="0" y="0" width="940" height="58" fill="#fdebd0" stroke="#e67e22" stroke-width="1" rx="3"/>
        <ns0:text x="10" y="155.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#e67e22">Step 3:</ns0:tspan>
           Normalize:
          <ns0:tspan font-family="Arial, sans-serif" dx="10">xÌ‚áµ¢ = (xáµ¢ - Î¼_ğ“‘) / âˆš(ÏƒÂ²_ğ“‘ + Îµ)</ns0:tspan>
          <ns0:tspan dx="10" font-size="11" fill="#1a237e">(Îµ â‰ˆ 10â»âµ for numerical stability)</ns0:tspan>
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 135)">
        <ns0:rect x="0" y="0" width="940" height="30" fill="#1a237e" stroke="#28a745" stroke-width="1" rx="3"/>
        <ns0:text x="10" y="180.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#2e7d32">Step 4:</ns0:tspan>
           Scale and shift (learnable parameters):
          <ns0:tspan font-family="Arial, sans-serif" dx="10">yáµ¢ = Î³xÌ‚áµ¢ + Î²</ns0:tspan>
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 175)">
        <ns0:text x="0" y="205.0" font-size="14" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#1565c0">Output:</ns0:tspan>
           Normalized and scaled values: {yâ‚, yâ‚‚, ..., y_m}
        </ns0:text>
        <ns0:text x="0" y="230.0" font-size="12" fill="#1a237e">
          Î³ and Î² are learned during training to restore representation power
        </ns0:text>
      </ns0:g>
    </ns0:g>
  </ns0:g>
  <ns0:g transform="translate(50, 360)">
    <ns0:text x="500" y="255.0" font-size="16" font-weight="bold" text-anchor="middle" fill="#2e7d32">
      2. Effect on Activation Distribution
    </ns0:text>
    <ns0:rect x="0" y="20" width="2250.0" height="220" fill="#1a237e" stroke="#28a745" stroke-width="3" rx="8"/>
    <ns0:g transform="translate(100, 60)">
      <ns0:text x="150" y="280.0" font-size="13" font-weight="bold" text-anchor="middle" fill="#c62828">
        Before Batch Norm
      </ns0:text>
      <ns0:g>
        <ns0:line x1="0" y1="120" x2="300" y2="120" stroke="#e0e0e0" stroke-width="2"/>
        <ns0:line x1="150" y1="0" x2="150" y2="130" stroke="#e0e0e0" stroke-width="1"/>
        <ns0:path d="M 30,120 Q 80,100 120,40 Q 140,80 200,110 Q 240,120 270,120" fill="#c62828" opacity="0.3" stroke="#dc3545" stroke-width="2"/>
        <ns0:text x="150" y="305.0" font-size="11" text-anchor="middle" fill="#1a237e">
          Î¼ â‰ˆ -2.3, Ïƒ â‰ˆ 5.1
        </ns0:text>
        <ns0:text x="150" y="330.0" font-size="11" text-anchor="middle" fill="#c62828">
          Unstable, covariate shift
        </ns0:text>
      </ns0:g>
    </ns0:g>
    <ns0:g transform="translate(430, 120)">
      <ns0:text x="0" y="355.0" font-size="13" font-weight="bold" fill="#2e7d32">
        Normalize
      </ns0:text>
      <ns0:path d="M 0,5 L 60,5" stroke="#28a745" stroke-width="3" marker-end="url(#arrowGreen)"/>
    </ns0:g>
    <ns0:g transform="translate(550, 60)">
      <ns0:text x="150" y="380.0" font-size="13" font-weight="bold" text-anchor="middle" fill="#2e7d32">
        After Batch Norm
      </ns0:text>
      <ns0:g>
        <ns0:line x1="0" y1="120" x2="300" y2="120" stroke="#e0e0e0" stroke-width="2"/>
        <ns0:line x1="150" y1="0" x2="150" y2="130" stroke="#e0e0e0" stroke-width="1"/>
        <ns0:path d="M 50,120 Q 100,60 150,20 Q 200,60 250,120" fill="#2e7d32" opacity="0.3" stroke="#145a32" stroke-width="2"/>
        <ns0:text x="150" y="405.0" font-size="11" text-anchor="middle" fill="#1a237e">
          Î¼ = 0, Ïƒ = 1
        </ns0:text>
        <ns0:text x="150" y="430.0" font-size="11" text-anchor="middle" fill="#2e7d32" font-weight="bold">
          Stable, consistent
        </ns0:text>
      </ns0:g>
    </ns0:g>
  </ns0:g>
  <ns0:g transform="translate(50, 620)">
    <ns0:text x="500" y="455.0" font-size="16" font-weight="bold" text-anchor="middle" fill="#1a237e">
      3. Key Benefits
    </ns0:text>
    <ns0:rect x="0" y="20" width="2250.0" height="160" fill="#1a237e" stroke="#fd7e14" stroke-width="2" rx="8"/>
    <ns0:g transform="translate(30, 50)">
      <ns0:g>
        <ns0:circle cx="8" cy="-3" r="8" fill="#e65100"/>
        <ns0:text x="8" y="480.0" font-size="11" font-weight="bold" text-anchor="middle" fill="#1a237e">1</ns0:text>
        <ns0:text x="25" y="505.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#e67e22">Faster Training:</ns0:tspan>
          Allows higher learning rates (10-100Ã— faster convergence)
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 30)">
        <ns0:circle cx="8" cy="-3" r="8" fill="#e65100"/>
        <ns0:text x="8" y="530.0" font-size="11" font-weight="bold" text-anchor="middle" fill="#1a237e">2</ns0:text>
        <ns0:text x="25" y="555.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#e67e22">Reduces Internal Covariate Shift:</ns0:tspan>
          Distribution of layer inputs stays stable during training
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 60)">
        <ns0:circle cx="8" cy="-3" r="8" fill="#e65100"/>
        <ns0:text x="8" y="580.0" font-size="11" font-weight="bold" text-anchor="middle" fill="#1a237e">3</ns0:text>
        <ns0:text x="25" y="605.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#e67e22">Acts as Regularizer:</ns0:tspan>
          Adds noise from mini-batch statistics â†’ Reduces need for Dropout
        </ns0:text>
      </ns0:g>
      <ns0:g transform="translate(0, 90)">
        <ns0:circle cx="8" cy="-3" r="8" fill="#e65100"/>
        <ns0:text x="8" y="630.0" font-size="11" font-weight="bold" text-anchor="middle" fill="#1a237e">4</ns0:text>
        <ns0:text x="25" y="655.0" font-size="13" fill="#1a237e">
          <ns0:tspan font-weight="bold" fill="#e67e22">Less Sensitive to Initialization:</ns0:tspan>
          Network becomes more robust to weight initialization schemes
        </ns0:text>
      </ns0:g>
    </ns0:g>
  </ns0:g>
  <ns0:rect x="50" y="800" width="490" height="40" fill="#e1f5fe" stroke="#007bff" stroke-width="2" rx="8"/>
  <ns0:text x="295" y="817" font-size="13" font-weight="bold" text-anchor="middle" fill="#1a5276">
    ğŸ”„ Inference Mode
  </ns0:text>
  <ns0:text x="295" y="842.0" font-size="11" text-anchor="middle" fill="#0277bd">
    Use running average: Î¼_running, ÏƒÂ²_running (tracked during training)
  </ns0:text>
  <ns0:rect x="560" y="800" width="490" height="40" fill="#1a237e" stroke="#6f42c1" stroke-width="2" rx="8"/>
  <ns0:text x="805" y="867.0" font-size="13" font-weight="bold" text-anchor="middle" fill="#6c3483">
    ğŸ“ Placement
  </ns0:text>
  <ns0:text x="805" y="892.0" font-size="11" text-anchor="middle" fill="#6a1b9a">
    After linear/conv layer, before activation (common practice)
  </ns0:text>
</ns0:svg>
