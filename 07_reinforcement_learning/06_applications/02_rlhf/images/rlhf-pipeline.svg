<?xml version="1.0" ?>
<ns0:svg xmlns:ns0="http://www.w3.org/2000/svg" viewBox="0.0 0.0 1800.0 1012.5">
  <ns0:rect width="1800.0" height="1012.5" fill="#f8f9fa" rx="8"/>
  <ns0:text x="400" y="35" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="22" font-weight="bold">RLHF Pipeline</ns0:text>
  <ns0:text x="400" y="58" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="12">Reinforcement Learning from Human Feedback</ns0:text>
  <ns0:rect x="30" y="90" width="170" height="140" rx="12" fill="#1a237e" stroke="#007bff" stroke-width="2"/>
  <ns0:circle cx="50" cy="110" r="15" fill="#1565c0"/>
  <ns0:text x="50" y="115" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="12" font-weight="bold">1</ns0:text>
  <ns0:text x="115" y="140.0" text-anchor="middle" fill="#1565c0" font-family="Arial, sans-serif" font-size="12" font-weight="bold">SFT</ns0:text>
  <ns0:text x="100" y="165.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">Supervised</ns0:text>
  <ns0:text x="100" y="190.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">Fine-Tuning</ns0:text>
  <ns0:text x="100" y="215.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">Train on human</ns0:text>
  <ns0:text x="100" y="240.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">demonstrations</ns0:text>
  <ns0:path d="M200 160 L230 160" stroke="#e0e0e0" stroke-width="2" marker-end="url(#arrow)"/>
  <ns0:rect x="240" y="90" width="170" height="140" rx="12" fill="#1a237e" stroke="#fd7e14" stroke-width="2"/>
  <ns0:circle cx="260" cy="110" r="15" fill="#e65100"/>
  <ns0:text x="260" y="265.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="12" font-weight="bold">2</ns0:text>
  <ns0:text x="325" y="290.0" text-anchor="middle" fill="#e65100" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Reward Model</ns0:text>
  <ns0:text x="325" y="315.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">Learn from</ns0:text>
  <ns0:text x="325" y="340.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">Preferences</ns0:text>
  <ns0:rect x="260" y="185" width="50" height="25" rx="4" fill="#2e7d32"/>
  <ns0:text x="285" y="365.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">A âœ“</ns0:text>
  <ns0:rect x="320" y="185" width="50" height="25" rx="4" fill="#c62828"/>
  <ns0:text x="345" y="390.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">B âœ—</ns0:text>
  <ns0:path d="M410 160 L440 160" stroke="#e0e0e0" stroke-width="2"/>
  <ns0:rect x="450" y="90" width="170" height="140" rx="12" fill="#1a237e" stroke="#28a745" stroke-width="2"/>
  <ns0:circle cx="470" cy="110" r="15" fill="#2e7d32"/>
  <ns0:text x="470" y="415.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="12" font-weight="bold">3</ns0:text>
  <ns0:text x="535" y="440.0" text-anchor="middle" fill="#2e7d32" font-family="Arial, sans-serif" font-size="12" font-weight="bold">RL (PPO)</ns0:text>
  <ns0:text x="535" y="465.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">Optimize policy</ns0:text>
  <ns0:text x="535" y="490.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">with reward model</ns0:text>
  <ns0:text x="535" y="515.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">+ KL penalty to</ns0:text>
  <ns0:text x="535" y="540.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">prevent drift</ns0:text>
  <ns0:path d="M620 160 L650 160" stroke="#e0e0e0" stroke-width="2"/>
  <ns0:rect x="660" y="90" width="120" height="140" rx="12" fill="#1a237e" stroke="#6f42c1" stroke-width="2"/>
  <ns0:circle cx="720" cy="110" r="15" fill="#6a1b9a"/>
  <ns0:text x="720" y="565.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="10" font-weight="bold">âœ“</ns0:text>
  <ns0:text x="720" y="590.0" text-anchor="middle" fill="#6a1b9a" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Aligned</ns0:text>
  <ns0:text x="720" y="615.0" text-anchor="middle" fill="#6a1b9a" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Model</ns0:text>
  <ns0:text x="720" y="640.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">ChatGPT, Claude</ns0:text>
  <ns0:rect x="240" y="280" width="340" height="140" rx="12" fill="#1a237e" stroke="#ec4899" stroke-width="2"/>
  <ns0:text x="410" y="665.0" text-anchor="middle" fill="#ec4899" font-family="Arial, sans-serif" font-size="14" font-weight="bold">ðŸ”¥ DPO Alternative</ns0:text>
  <ns0:text x="410" y="690.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="11">Direct Preference Optimization</ns0:text>
  <ns0:text x="410" y="715.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="10">Skip reward model! Train directly on preferences.</ns0:text>
  <ns0:text x="410" y="740.0" text-anchor="middle" fill="#1a237e" font-family="Arial, sans-serif" font-size="9">L = -log Ïƒ(Î² log(Ï€/Ï€_ref)_w - Î² log(Ï€/Ï€_ref)_l)</ns0:text>
</ns0:svg>