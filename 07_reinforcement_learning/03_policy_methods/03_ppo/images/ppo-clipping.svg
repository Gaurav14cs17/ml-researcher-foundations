<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 800">
  <!-- Title -->
  <text x="450" y="30" font-size="22" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    PPO (Proximal Policy Optimization): Clipped Objective
  </text>
  
  <!-- PPO Objective -->
  <g transform="translate(50, 70)">
    <rect x="0" y="0" width="800" height="120" fill="#e3f2fd" stroke="#2196f3" stroke-width="3" rx="10"/>
    <text x="400" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#1565c0">
      PPO Objective (Clipped Surrogate)
    </text>
    <text x="400" y="60" font-size="16" font-family="monospace" text-anchor="middle" fill="#0d47a1">
      L^CLIP(Œ∏) = ùîº[min(r_t(Œ∏)¬∑√Ç_t, clip(r_t(Œ∏), 1-Œµ, 1+Œµ)¬∑√Ç_t)]
    </text>
    <g transform="translate(50, 80)">
      <text x="0" y="0" font-size="12" fill="#7f8c8d">
        r_t(Œ∏) = œÄ_Œ∏(a_t|s_t) / œÄ_Œ∏_old(a_t|s_t)  (probability ratio)
      </text>
      <text x="430" y="0" font-size="12" fill="#7f8c8d">
        Œµ = 0.2 (typical clip range)
      </text>
    </g>
  </g>
  
  <!-- The Clipping Mechanism -->
  <g transform="translate(50, 220)">
    <text x="400" y="0" font-size="16" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Clipping Mechanism: Preventing Too-Large Updates
    </text>
    
    <rect x="0" y="20" width="800" height="350" fill="#f5f5f5" stroke="#95a5a6" stroke-width="2" rx="8"/>
    
    <!-- Axes -->
    <line x1="80" y1="330" x2="720" y2="330" stroke="#34495e" stroke-width="2"/>
    <line x1="400" y1="50" x2="400" y2="350" stroke="#34495e" stroke-width="2"/>
    
    <!-- Labels -->
    <text x="400" y="370" font-size="13" text-anchor="middle" fill="#2c3e50">r = œÄ_new/œÄ_old (Probability Ratio)</text>
    <text x="40" y="195" font-size="13" text-anchor="middle" fill="#2c3e50" transform="rotate(-90 40 195)">
      Objective Contribution
    </text>
    
    <!-- X-axis ticks -->
    <line x1="240" y1="325" x2="240" y2="335" stroke="#34495e" stroke-width="1"/>
    <text x="240" y="350" font-size="11" text-anchor="middle" fill="#7f8c8d">0.8</text>
    <text x="240" y="365" font-size="10" text-anchor="middle" fill="#e74c3c">(1-Œµ)</text>
    
    <line x1="400" y1="325" x2="400" y2="335" stroke="#34495e" stroke-width="1"/>
    <text x="400" y="350" font-size="11" text-anchor="middle" fill="#7f8c8d">1.0</text>
    <text x="400" y="365" font-size="10" text-anchor="middle" fill="#27ae60">(no change)</text>
    
    <line x1="560" y1="325" x2="560" y2="335" stroke="#34495e" stroke-width="1"/>
    <text x="560" y="350" font-size="11" text-anchor="middle" fill="#7f8c8d">1.2</text>
    <text x="560" y="365" font-size="10" text-anchor="middle" fill="#e74c3c">(1+Œµ)</text>
    
    <!-- Positive Advantage (A > 0) -->
    <g>
      <text x="600" y="90" font-size="14" font-weight="bold" fill="#27ae60">Advantage > 0</text>
      <text x="600" y="108" font-size="11" fill="#7f8c8d">(Good action, increase prob)</text>
      
      <!-- Unclipped (dashed line) -->
      <path d="M 120,310 L 680,110" stroke="#95a5a6" stroke-width="2" stroke-dasharray="5,5"/>
      <text x="680" y="105" font-size="10" fill="#95a5a6">Unclipped</text>
      
      <!-- Clipped (solid line) -->
      <path d="M 120,310 L 400,190 L 560,130 L 680,130" stroke="#27ae60" stroke-width="4"/>
      <text x="620" y="125" font-size="11" font-weight="bold" fill="#27ae60">Clipped at 1+Œµ</text>
      
      <!-- Clip markers -->
      <circle cx="560" cy="130" r="5" fill="#f39c12" stroke="#e67e22" stroke-width="2"/>
      <line x1="560" y1="50" x2="560" y2="330" stroke="#f39c12" stroke-width="2" stroke-dasharray="3,3"/>
    </g>
    
    <!-- Negative Advantage (A < 0) -->
    <g>
      <text x="200" y="250" font-size="14" font-weight="bold" fill="#e74c3c">Advantage &lt; 0</text>
      <text x="200" y="268" font-size="11" fill="#7f8c8d">(Bad action, decrease prob)</text>
      
      <!-- Unclipped (dashed line) -->
      <path d="M 120,150 L 680,350" stroke="#95a5a6" stroke-width="2" stroke-dasharray="5,5"/>
      
      <!-- Clipped (solid line) -->
      <path d="M 120,290 L 240,290 L 400,250 L 680,150" stroke="#e74c3c" stroke-width="4"/>
      <text x="180" y="285" font-size="11" font-weight="bold" fill="#e74c3c">Clipped at 1-Œµ</text>
      
      <!-- Clip markers -->
      <circle cx="240" cy="290" r="5" fill="#f39c12" stroke="#e67e22" stroke-width="2"/>
      <line x1="240" y1="50" x2="240" y2="330" stroke="#f39c12" stroke-width="2" stroke-dasharray="3,3"/>
    </g>
  </g>
  
  <!-- Explanation Boxes -->
  <g transform="translate(50, 600)">
    <text x="400" y="0" font-size="16" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Why Clipping Works
    </text>
    
    <!-- Left box -->
    <rect x="0" y="20" width="390" height="130" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
    <text x="195" y="45" font-size="13" font-weight="bold" text-anchor="middle" fill="#1b5e20">
      ‚úì Conservative Updates
    </text>
    <g transform="translate(15, 60)">
      <text x="0" y="0" font-size="12" fill="#2c3e50">
        ‚Ä¢ Prevents too-large policy changes
      </text>
      <text x="0" y="20" font-size="12" fill="#2c3e50">
        ‚Ä¢ Keeps new policy close to old
      </text>
      <text x="0" y="40" font-size="12" fill="#2c3e50">
        ‚Ä¢ Stable training (no divergence)
      </text>
      <text x="0" y="60" font-size="12" fill="#2c3e50">
        ‚Ä¢ Safe exploration
      </text>
    </g>
    
    <!-- Right box -->
    <rect x="410" y="20" width="390" height="130" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
    <text x="605" y="45" font-size="13" font-weight="bold" text-anchor="middle" fill="#e65100">
      üéØ Key Insight
    </text>
    <g transform="translate(425, 60)">
      <text x="0" y="0" font-size="12" fill="#2c3e50">
        ‚Ä¢ r &gt; 1+Œµ: Don't increase prob too much
      </text>
      <text x="0" y="20" font-size="12" fill="#2c3e50">
        ‚Ä¢ r &lt; 1-Œµ: Don't decrease prob too much
      </text>
      <text x="0" y="40" font-size="12" fill="#2c3e50">
        ‚Ä¢ Within [0.8, 1.2]: Use actual ratio
      </text>
      <text x="0" y="60" font-size="12" font-weight="bold" fill="#f57c00">
        ‚Üí Pessimistic bound on improvement!
      </text>
    </g>
  </g>
  
  <!-- Algorithm Summary -->
  <rect x="50" y="760" width="800" height="30" fill="#e1f5fe" stroke="#0288d1" stroke-width="2" rx="8"/>
  <text x="450" y="782" font-size="12" text-anchor="middle" fill="#01579b">
    <tspan font-weight="bold">PPO Algorithm:</tspan> Sample trajectories ‚Üí Compute advantages ‚Üí Update policy by maximizing L^CLIP ‚Üí Repeat
  </text>
</svg>

